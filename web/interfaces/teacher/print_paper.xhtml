<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core" xml:lang="en" lang="en">
	<head>
		<title>打印试卷</title>
		<meta http-equiv="keywords" content="enter,your,keywords,here" />
		<meta http-equiv="description"
			content="A short description of this page." />
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

		<!--<link rel="stylesheet" type="text/css" href="styles.css">-->
		<script charset="GBK" type="text/javascript" src="../include/confirmandcancel.js"></script>
		<script type="text/javascript" src="../include/browserFolder.js"></script>
	</head>
	<body>
	<div>
		<h:form>
		<table bgcolor="#D3D3D3">
		<tr align="right">
		<td>
			<h:outputLabel>学校</h:outputLabel>
		</td>
		<td>
			<h:selectOneMenu value="#{PrintAction.schoolId}" onchange="submit()" style="width: 100px "
							 valueChangeListener="#{PrintAction.changeStateSchool}">
				<c:forEach var="school" items="#{PrintAction.schools}">
					<f:selectItem itemValue="#{school.id}" itemLabel="#{school.name}" />
				</c:forEach>
			</h:selectOneMenu>
		</td>
		<td>
			<h:outputLabel>院系</h:outputLabel>
		</td>
		<td>
			<h:selectOneMenu value="#{PrintAction.instituteId}" onchange="submit()" style="width: 100px "
							 valueChangeListener="#{PrintAction.changeStateIns}">
				<f:selectItem itemValue="0" itemLabel="请选择" />
				<c:forEach var="institute" items="#{PrintAction.institutes}">
					<f:selectItem itemValue="#{institute.id}" itemLabel="#{institute.name}" />
				</c:forEach>
			</h:selectOneMenu>
		</td>
		<td>
			<h:outputLabel>专业</h:outputLabel>
		</td>
		<td>
			<h:selectOneMenu id="majorId" value="#{PrintAction.majorId}" onchange="submit()" style="width: 100px "
							 valueChangeListener="#{PrintAction.changeStateMajor}">
				<f:selectItem itemValue="0" itemLabel="请选择" />
				<c:forEach var="major" items="#{PrintAction.majors}">
					<f:selectItem itemValue="#{major.id}" itemLabel="#{major.name}" />
				</c:forEach>
			</h:selectOneMenu>
		</td>
		<td>
			<h:outputLabel>班级</h:outputLabel>
		</td>
		<td>
			<h:selectOneMenu id="classId" value="#{PrintAction.classId}" style="width: 100px "
				valueChangeListener="#{PrintAction.changeStateClass}" onchange="submit()">
				<f:selectItem itemValue="0" itemLabel="请选择" />
				<c:forEach var="class" items="#{PrintAction.classes}">
					<f:selectItem itemValue="#{class.id}" itemLabel="#{class.name}" />
				</c:forEach>
			</h:selectOneMenu>
		</td>
		<td>
			<h:outputLabel>科目</h:outputLabel>
		</td>
		<td>
			<h:selectOneMenu value="#{PrintAction.courseId}" style="width: 100px ">
				<f:selectItem itemValue="0" itemLabel="请选择" />
				<c:forEach var="course" items="#{PrintAction.courses}">
					<f:selectItem itemValue="#{course.id}" itemLabel="#{course.name}" />
				</c:forEach>
			</h:selectOneMenu>
		</td>
		</tr>
		</table>
		<table  bgcolor="#D3D3D3">
		
		<tr>
		<td>
		</td>
			<td width="198px">
			<h:commandLink action="#{PrintAction.printTestPaper}" style="text-decoration: none">预览试卷</h:commandLink>
			</td>
		<td>
			
		</td>
		<td>
		</td>
		<td>
			试卷名称
		</td>
		<td>
			<h:inputText value="#{PrintAction.fileName1}"></h:inputText>
		</td>
		<td>
		</td>
		<td>
			答题纸名称
		</td>
		<td>
			<h:inputText value="#{PrintAction.fileName2}"></h:inputText>
		</td>
		<td>
		</td>
		</tr>
		<tr>
		<td>
		</td>
		<td>
			<h:commandLink action="#{PrintAction.printAnswerPaper}" style="text-decoration: none">预览答题纸</h:commandLink>
		</td>
		<td>
		</td>
		<td>
		</td>
		<td>
			
		</td>
		<td>
			<h:commandButton onclick="" action="#{PrintAction.downloadWord}" value="打印试卷"></h:commandButton>
		</td>
		<td>
		</td>
		<td>
		</td>
		<td>
		<h:commandButton onclick="" action="#{PrintAction.downloadWord2}" value="打印答题纸"></h:commandButton>
		</td>
		<td>
		</td>
		</tr>
		</table>
		</h:form>
		</div>
		
		<!--预览-->
		<div id="print">
			<c:if test="${PrintAction.pages==1}">
				<c:if test="${PrintAction.isStus==1}">
				<c:if test="${PrintAction.ispaper==1}">
					<h:form>
						<table>
						<tr>
						<td>
						<c:forEach var="stu" items="#{PrintAction.students}">
							<hr/>
								<h3>#{stu.number}.&nbsp;&nbsp;班级：
									<c:forEach var="cla" items="#{PrintAction.classes}">
										<c:if test="${cla.id==stu.classid}">
											#{cla.name}
										</c:if>
									</c:forEach>
									&nbsp;&nbsp;&nbsp;
									姓名：#{stu.name}&nbsp;&nbsp;&nbsp;学号：#{stu.stuno}
									<c:forEach var="course" items="#{PrintAction.courses}">
										<c:if test="${PrintAction.courseId==course.id}">
											
										</c:if>
									</c:forEach>
									<br></br>
									考试开始时间：#{PrintAction.year}年#{PrintAction.month}月#{PrintAction.day}日
									#{PrintAction.hour}时#{PrintAction.minute}分&nbsp;&nbsp;&nbsp;考试时长：#{PrintAction.testassigninfo.testinterval}分钟
								</h3>
								<div id="yu" style="display: block">
								<c:forEach var="questype" items="#{PrintAction.listQuestionType}">
									<h1>#{questype.name}。</h1><br />
									<c:forEach var="ql" items="#{PrintAction.qListMap}">
										<c:forEach var="qm" items="${ql}">
											<c:if test="${qm.key==stu.id}">
												<c:forEach var="ques" items="${qm.value}">
												<div style="background-color: white;">
												<c:if test="${ques.questiontype==questype.id}">
													#{ques.number} . &nbsp;
													<c:if test="${ques.questiontype==1}">
														#{ques.content}
														<c:forEach items="#{ques.pagecontent}" var="s">
															#{s.contentstring}"
														</c:forEach>
													</c:if>
													<c:if test="${ques.questiontype==2}">
														#{ques.content} &nbsp;( #{ques.score}分)<br/>
														<c:forEach items="#{ques.pagecontent}" var="s">
															#{s.contentstring}"
														</c:forEach>
													</c:if>
														<c:if test="${ques.questiontype==3}">
															<c:forEach items="#{ques.pagecontent}" var="s" end="0">
																#{s.contentstring}
															</c:forEach>
															<c:forEach items="#{ques.pagecontent}" var="s" begin="1">
															_______________&nbsp;&nbsp;#{s.contentstring}
															</c:forEach>
															&nbsp;( #{ques.score}分)<br/>
														</c:if>
													<c:if test="${ques.questiontype==4}">
														#{ques.content} &nbsp;( #{ques.score}分)<br/>
														</c:if>
													<c:if test="${ques.questiontype==5}">
														#{ques.content} &nbsp;( #{ques.score}分)<br />
													</c:if>
													<c:if test="${ques.questiontype==6}">
														<c:forEach items="#{ques.pagecontent}" var="s">
															<br />#{s.contentstring}
														</c:forEach>
														&nbsp;( #{ques.score}分)<br />
													</c:if>
													<c:if test="${ques.questiontype==7}">
														<c:forEach items="#{ques.pagecontent}" var="s" end="0">
															#{s.contentstring}
														</c:forEach>
														<c:forEach items="#{ques.pagecontent}" var="s" begin="1">
															<h:inputText value="#{s.boxvalue}"></h:inputText>#{s.contentstring}
														</c:forEach>
														&nbsp;( #{ques.score}分)<br />
													</c:if>
													<c:if test="${ques.questiontype==8}">
														#{ques.content} &nbsp;( #{ques.score}分)<br />
														<h:selectOneRadio value="#{ques.pageanswer}" layout="pageDirection">
															<c:forEach items="#{ques.selectionlist}" var="s">
																<f:selectItem itemLabel="#{s}"></f:selectItem>
															</c:forEach>
														</h:selectOneRadio>
													</c:if>
													<br />
												</c:if>
												</div>
											</c:forEach>
											</c:if>
										</c:forEach>
									</c:forEach>
								</c:forEach>
							</div>
						</c:forEach>
						</td>
						</tr>
						</table>
					</h:form>
				</c:if>
				<c:if test="${PrintAction.ispaper==0}">
					<h1>该班级该科目的考试还未安排</h1>
				</c:if>
				</c:if>
				<c:if test="${PrintAction.isStus==0}">
					<h1>
						未录入该班级学生信息！
					</h1>
				</c:if>
			</c:if>
			
			<!-- 答题纸 -->
			<c:if test="${PrintAction.pages==2}">
				<c:if test="${PrintAction.isStus==1}">
				<c:if test="${PrintAction.ispaper==1}">
					<h:form>
						<table>
							<c:forEach var="stu" items="#{PrintAction.students}">
							<hr/>
							<h3>#{stu.number}.&nbsp;&nbsp;班级：
										<c:forEach var="cla" items="#{PrintAction.classes}">
											<c:if test="${cla.id==stu.classid}">
											#{cla.name}
										</c:if>
										</c:forEach>
										&nbsp;&nbsp;&nbsp;
										姓名：#{stu.name}&nbsp;&nbsp;&nbsp;学号：#{stu.stuno}
										<c:forEach var="course" items="#{PrintAction.courses}">
											<c:if test="${PrintAction.courseId==course.id}">
											
										</c:if>
										</c:forEach>
										<br></br>
										考试开始时间：#{PrintAction.year}年#{PrintAction.month}月#{PrintAction.day}日
										#{PrintAction.hour}时#{PrintAction.minute}分&nbsp;&nbsp;&nbsp;考试时长：#{PrintAction.testassigninfo.testinterval}分钟
							</h3>
									
							<div style="display: block">
								<c:forEach var="questype" items="#{PrintAction.listQuestionType}">
									<h1>#{questype.name}。</h1><br />
									<c:forEach var="ql" items="#{PrintAction.qListMap}">
										<c:forEach var="qm" items="${ql}">
											<c:if test="${qm.key==stu.id}">
												<c:forEach var="ques" items="${qm.value}">
												<div style="background-color: white;">
												<c:if test="${ques.questiontype==questype.id}">
													#{ques.number} . &nbsp;
													<c:if test="${ques.questiontype==1}">
										(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) &nbsp;( #{ques.score}分)<br />
									</c:if>
									<c:if test="${ques.questiontype==2}">
										(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) &nbsp;( #{ques.score}分)<br />
									</c:if>
									<c:if test="${ques.questiontype==3}">
										_________________&nbsp;( #{ques.score}分)<br />
									</c:if>
									<c:if test="${ques.questiontype==4}">
										&nbsp;( #{ques.score}分)<br />
										<h:inputTextarea rows="10" cols="50" >
										</h:inputTextarea>
									</c:if>
									<c:if test="${ques.questiontype==5}">
										&nbsp;( #{ques.score}分)<br />
										<h:inputTextarea rows="10" cols="50" >
										</h:inputTextarea>
									</c:if>
									<c:if test="${ques.questiontype==6}">
										&nbsp;( #{ques.score}分)<br />
										<h:inputTextarea rows="30" cols="50" ></h:inputTextarea>
									</c:if>
									<c:if test="${ques.questiontype==7}">
										<c:forEach items="#{ques.pagecontent}" var="s" end="0">
											________________、
										</c:forEach>
									<c:forEach items="#{ques.pagecontent}" var="s" begin="1">
										________________、	
									</c:forEach>
									&nbsp;( #{ques.score}分)<br />
									</c:if>
								<c:if test="${ques.questiontype==8}">
										#{ques.content} &nbsp;( #{ques.score}分)<br />
										(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)
								</c:if>
								<br />
												</c:if>
												</div>
												</c:forEach>
											</c:if>
										</c:forEach>
									</c:forEach>
								</c:forEach>
							</div>
							</c:forEach>
						</table>
					</h:form>	
					</c:if>
				<c:if test="${PrintAction.ispaper==0}">
					该班级该科目的考试还未安排
				</c:if>
				</c:if>
				<c:if test="${PrintAction.isStus==0}">
					<h1>未录入该班级学生信息！</h1>
				</c:if>
			</c:if>
		</div>
	</body>
</html>
