<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j">

    <body>

        <ui:composition template="./../../stylemodel.xhtml">

            <ui:define name="content">

                <style type="text/css">
                    #basicGChart { width: 450px; height: 300px }
                </style>

                <script type="text/javascript" src="../../resources/javascript/highcharts.js"></script>
                <script type="text/javascript" src="../../resources/javascript/exporting.js"></script>       

                <h:form onclick="#{teacherController.showTeachercourseclass()}" id="mynewForm">

                    <h:inputHidden id="picData" value="#{studentinfoController.scoreLevelNum}"></h:inputHidden>

                    所教课程：
                    <h:selectOneMenu  id="course" valueChangeListener="#{teachercourseclassController.typeCourseListener}" >
                        <f:selectItem itemLabel="----请选择课程----" itemValue="0"></f:selectItem>
                        <f:selectItems value="#{teacherController.teacherCourseList}"></f:selectItems>
                        <f:ajax event="change" render="classId"></f:ajax>
                    </h:selectOneMenu>
                    所教班级：
                    <h:selectOneMenu id="classId" valueChangeListener="#{studentinfoController.typeClassListener}">
                        <f:selectItem itemLabel="----请选择班级----" itemValue="0"></f:selectItem>
                        <f:selectItems value="#{teachercourseclassController.itemsAvailableSelectByCourseId}"></f:selectItems>
                        <f:ajax event="change"></f:ajax>
                    </h:selectOneMenu>
                     <a4j:commandButton value="查看" oncomplete="show_scorePic()"  execute="picData" render="username myPanel" action="#{studentinfoController.getScoreData()}"></a4j:commandButton>
                     <rich:panel title="查看班级考试情况" style="margin-left: 200px" id="myPanel">
                        <div id="container1">
                        </div>         
                    </rich:panel>
                   
                    <script>
                        function show_scorePic() {
                            var scoreData = document.getElementById("mynewForm:picData").value;
                            
                            var array = scoreData.split(",");
                            alert("1");
                            var arr=eval(array[0]);         
                            var arr2=eval(array[1]);
                            var arr3=eval(array[2]);
                            var arr4=eval(array[3]);
                            var arr5=eval(array[4]);
                            $('#container1').highcharts({
                                title: {
                                    text: '学生成绩反馈表',
                                    x: -20 //center
                                },
                                subtitle: {
                                    text: '来自数据库',
                                    x: -20
                                },
                                xAxis: {
                                    categories: ['0~59分', '60~69分', '70~79分', '80~89分', '90~100分']
                                },
                                yAxis: {
                                    title: {
                                        text: '人数 (人)'
                                    },
                                    plotLines: [{
                                            value: 0,
                                            width: 1,
                                            color: '#808080'
                                        }]
                                },
                                tooltip: {
                                    valueSuffix: '人'
                                },
                                legend: {
                                    layout: 'vertical',
                                    align: 'right',
                                    verticalAlign: 'middle',
                                    borderWidth: 0
                                },
                                series: [{
                                        name: '学生成绩曲线',
                                        data: [arr,arr2,arr3,arr4,arr5]
                                    }]
                            });

                        }

                    </script>

                </h:form>
            </ui:define>
        </ui:composition>
    </body>
</html>
